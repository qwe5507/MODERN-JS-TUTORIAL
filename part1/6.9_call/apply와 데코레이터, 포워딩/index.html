<!doctype html>
<script src="https://ko.js.cx/test/libs.js"></script>
<script src="test.js"></script>
<script>
    //스파이 데코레이터 
    function work(a, b) {
        alert(a + b); // work is an arbitrary function or method
    }
    function spy(func) {
        let cache = new Map();

        function asd(...arg) {

            let key = arg; // (*)
            if (cache.has(key)) {
                return cache.get(key);
            }

            asd.calls.push(key);
            console.log(arg)
            let result = func.call(this, ...arg); // (**)
            cache.set(key, result);
            return result;
        };
        asd.calls = [];
        return asd;
    }
    // work = spy(work);

    // work(1, 2); // 3
    // work(4, 5); // 9

    // for (let args of work.calls) {
    //     alert('call:' + args.join()); // "call:1,2", "call:4,5"
    // }

    //지연 데코레이터
    // let user = {
    //     sayHi: function (phrase, who) {
    //         assert.equal(this, user);
    //         assert.equal(phrase, "test");
    //         assert.equal(who, "John");
    //         assert.equal(Date.now() - start, 1500);
    //     }
    // };

    function delay(f, ms) {

        return function (...args) {
            let savedThis = this; // store this into an intermediate variable
            console.log(savedThis);
            setTimeout(function () {
                f.apply(savedThis, args); // use it here
            }, ms);
        };

    }

    // // create wrappers
    user.sayHi = delay(user.sayHi, 1000);
    user.sayHi = delay(user.sayHi, 1500);

    user.sayHi("test"); // shows "test" after 1000ms
    user.sayHi("test"); // shows "test" after 1500ms

    //디바운스 데코레이터
    

</script>

</html>